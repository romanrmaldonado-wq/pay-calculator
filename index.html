<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pay Period Calculator</title>
    <meta name="description" content="Track appointments, estimates, and calculate pay bonuses">
    <meta name="theme-color" content="#198754">
    
    <!-- PWA Support -->
    <link rel="manifest" href="manifest.json">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    
    <style>
        :root {
            --phr-blue: #1a3c6e;
            --phr-light-blue: #4a90d9;
        }
        
        body {
            background-color: #f5f7fa;
        }
        
        .tables-wrapper {
            display: flex;
            flex-wrap: wrap; 
            gap: 20px;
        }
        .tables-wrapper > table {
            flex: 1 1 100%; 
        }
        th {
            width: 100px;
        }
        @media (min-width: 768px) {
            .tables-wrapper > table {
                flex: 1 1 calc(50% - 20px); 
            }
        }
        .th-input {
            width: 100%; 
            height: 30px; 
            box-sizing: border-box; 
            text-align: center;
            border: none;
            border-radius: 4px;
        }
        .card-body h1 {
            font-size: 38px;
            font-weight: bold;
            color: #198754;
        }
        .table-container {
            max-width: 100%; 
            height: auto;
        }
        .grand-totals {
            background-color: #FFFF8F;
            padding: 10px;
            border-radius: 5px;
        }
        
        /* Account Activity Styles - Matching Power Home */
        .activity-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .activity-section h2 {
            text-align: center;
            color: var(--phr-blue);
            font-size: 18px;
            font-weight: 600;
            letter-spacing: 2px;
            text-transform: uppercase;
            margin-bottom: 20px;
        }
        
        .activity-card {
            background: white;
            border: 1px solid #e8ecf0;
            border-radius: 12px;
            margin-bottom: 15px;
            overflow: hidden;
        }
        
        .activity-day {
            padding: 15px 20px;
            color: #5a6a7a;
            font-weight: 600;
            font-size: 13px;
            letter-spacing: 1px;
            text-transform: uppercase;
            border-bottom: 1px solid #f0f2f5;
        }
        
        .activity-description {
            padding: 15px 20px;
            border-bottom: 1px solid #f0f2f5;
        }
        
        .activity-description-label {
            color: #8a9bab;
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-bottom: 5px;
        }
        
        .activity-description-title {
            color: var(--phr-blue);
            font-size: 18px;
            font-weight: 500;
            margin-bottom: 3px;
        }
        
        .activity-description-detail {
            color: #7a8a9a;
            font-size: 14px;
        }
        
        .activity-amount {
            padding: 15px 20px;
        }
        
        .activity-amount-label {
            color: #8a9bab;
            font-size: 11px;
            font-weight: 600;
            letter-spacing: 1px;
            text-transform: uppercase;
            margin-bottom: 5px;
        }
        
        .activity-amount-value {
            color: var(--phr-blue);
            font-size: 20px;
            font-weight: 600;
        }
        
        .no-activity {
            text-align: center;
            color: #9aa;
            padding: 40px;
            font-style: italic;
        }
        
        /* Monthly/Quarterly Bonus Section */
        .bonus-section {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .bonus-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            height: 100%;
        }
        
        .bonus-card h3 {
            color: var(--phr-blue);
            font-size: 14px;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .bonus-options {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .bonus-option {
            display: flex;
            align-items: center;
            padding: 8px 12px;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            border: 1px solid #e8ecf0;
        }
        
        .bonus-option:hover {
            border-color: var(--phr-blue);
        }
        
        .bonus-option input[type="checkbox"] {
            margin-right: 10px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }
        
        .bonus-option input[type="checkbox"]:checked + .bonus-label {
            color: var(--phr-blue);
            font-weight: 600;
        }
        
        .bonus-label {
            flex: 1;
            color: #5a6a7a;
            font-size: 14px;
        }
        
        .bonus-amount {
            color: #198754;
            font-weight: 600;
            font-size: 14px;
        }
        
        .bonus-option:has(input:checked) {
            background: #e8f5e9;
            border-color: #198754;
        }
        
        @media (max-width: 768px) {
            .table {
                width: 100%; 
                table-layout: fixed; 
            }
            .table th, .table td {
                word-wrap: break-word;
                padding: 7px; 
                font-size: 10px;
            }
            .th-input {
                width: 27px; 
                height: 25px; 
                font-size: 10px;
                box-sizing: border-box; 
            }
            #card_1 {
                margin-top: 0 !important;
            }
            .card-body h1 {
                font-size: 30px;
                font-weight: bold;
                color: #198754;
            }
            .activity-section {
                padding: 15px;
                margin-left: -10px;
                margin-right: -10px;
                border-radius: 0;
            }
        }
        
        /* Clear button styling */
        .btn-clear {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        /* Row labels */
        .row-label {
            font-size: 10px;
            color: #fff;
            writing-mode: vertical-rl;
            text-orientation: mixed;
            padding: 2px;
        }
        
        @media (max-width: 768px) {
            .row-label {
                font-size: 8px;
            }
        }
    </style>
</head>
<body>
    
    <div class="container-fluid mt-2">
        <form id="jms_pay_period_calc_form" name="jms_pay_period_calc_form">
            <div style="display: flex; gap: 20px;" class="tables-wrapper">
                <!-- Week 1 Table -->
                <table class="table table-bordered border-dark tbl-1">
                    <tr>
                        <th colspan="9" class="bg-dark text-success small text-center">Week 1</th>
                    </tr>
                    <tr class="text-dark text-center">
                        <th class="bg-dark"></th>
                        <th class="bg-dark text-success small">M</th>
                        <th class="bg-dark text-success small">T</th>
                        <th class="bg-dark text-success small">W</th>
                        <th class="bg-dark text-success small">T</th>
                        <th class="bg-dark text-success small">F</th>
                        <th class="bg-dark text-success small">S</th>
                        <th class="bg-dark text-success small">S</th>
                        <th class="bg-dark text-success small">Total</th>
                    </tr>
                    <tr>
                        <th class="bg-dark text-light small row-label">Appts</th>
                        <th class="bg-primary"><input type="number" class="th-input" id="mon_w1_user_input_first_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-primary"><input type="number" class="th-input" id="tue_w1_user_input_first_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-primary"><input type="number" class="th-input" id="wed_w1_user_input_first_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-primary"><input type="number" class="th-input" id="thu_w1_user_input_first_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-primary"><input type="number" class="th-input" id="fri_w1_user_input_first_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-secondary"><input type="number" class="th-input" id="sat_w1_user_input_first_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-secondary"><input type="number" class="th-input" id="sun_w1_user_input_first_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-dark text-success text-center" id="w1_first_row_total">0</th>
                    </tr>
                    <tr>
                        <th class="bg-dark text-light small row-label">Ests</th>
                        <th class="bg-primary"><input type="number" class="th-input" id="mon_w1_user_input_second_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-primary"><input type="number" class="th-input" id="tue_w1_user_input_second_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-primary"><input type="number" class="th-input" id="wed_w1_user_input_second_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-primary"><input type="number" class="th-input" id="thu_w1_user_input_second_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-primary"><input type="number" class="th-input" id="fri_w1_user_input_second_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-secondary"><input type="number" class="th-input" id="sat_w1_user_input_second_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-secondary"><input type="number" class="th-input" id="sun_w1_user_input_second_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-dark text-success text-center" id="w1_second_row_total">0</th>
                    </tr>
                </table>
            
                <!-- Week 2 Table -->
                <table class="table table-bordered border-dark tbl-2">
                    <tr>
                        <th colspan="9" class="bg-dark text-success small text-center">Week 2</th>
                    </tr>
                    <tr class="text-dark text-center">
                        <th class="bg-dark"></th>
                        <th class="bg-dark text-success small">M</th>
                        <th class="bg-dark text-success small">T</th>
                        <th class="bg-dark text-success small">W</th>
                        <th class="bg-dark text-success small">T</th>
                        <th class="bg-dark text-success small">F</th>
                        <th class="bg-dark text-success small">S</th>
                        <th class="bg-dark text-success small">S</th>
                        <th class="bg-dark text-success small">Total</th>
                    </tr>
                    <tr>
                        <th class="bg-dark text-light small row-label">Appts</th>
                        <th class="bg-primary"><input type="number" class="th-input" id="mon_w2_user_input_first_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-primary"><input type="number" class="th-input" id="tue_w2_user_input_first_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-primary"><input type="number" class="th-input" id="wed_w2_user_input_first_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-primary"><input type="number" class="th-input" id="thu_w2_user_input_first_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-primary"><input type="number" class="th-input" id="fri_w2_user_input_first_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-secondary"><input type="number" class="th-input" id="sat_w2_user_input_first_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-secondary"><input type="number" class="th-input" id="sun_w2_user_input_first_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-dark text-success text-center" id="w2_first_row_total">0</th>
                    </tr>
                    <tr>
                        <th class="bg-dark text-light small row-label">Ests</th>
                        <th class="bg-primary"><input type="number" class="th-input" id="mon_w2_user_input_second_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-primary"><input type="number" class="th-input" id="tue_w2_user_input_second_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-primary"><input type="number" class="th-input" id="wed_w2_user_input_second_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-primary"><input type="number" class="th-input" id="thu_w2_user_input_second_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-primary"><input type="number" class="th-input" id="fri_w2_user_input_second_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-secondary"><input type="number" class="th-input" id="sat_w2_user_input_second_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-secondary"><input type="number" class="th-input" id="sun_w2_user_input_second_row" value="0" min="0" inputmode="numeric"></th>
                        <th class="bg-dark text-success text-center" id="w2_second_row_total">0</th>
                    </tr>
                </table>

                <div class="container-fluid d-flex justify-content-center align-items-center">
                    <div class="row w-100">
                        <!-- Table Section -->
                        <div class="col-12 col-md-6">
                            <div class="card mt-4 p-3" id="card_1">
                                <div class="table-responsive">
                                    <table class="table table-bordered border-dark tbl-3">
                                        <thead>
                                            <tr class="text-dark text-center">
                                                <th class="text-success">Hours Worked</th>
                                                <th class="text-success">Total Estimates</th>
                                                <th class="text-success">Commission</th>
                                                <th class="text-success">Combined</th>
                                                <th class="text-success">Appointment Bonus</th>
                                                <th class="text-success">Base Pay</th>
                                            </tr>
                                            <tr>
                                                <th>
                                                    <input type="number" class="form-control text-dark text-center" value="0" id="hours_worked_count_total" min="0" step="0.5" inputmode="decimal">
                                                </th>
                                                <th>
                                                    <input type="text" class="form-control text-dark text-center" value="0" id="total_estimates_count_total" readonly>
                                                </th>
                                                <th>
                                                    <input type="text" class="form-control text-dark text-center" value="$0" id="commission_total_count" readonly>
                                                </th>
                                                <th>
                                                    <input type="text" class="form-control text-dark text-center" value="$0" id="combined_total_count" readonly>
                                                </th>
                                                <th>
                                                    <input type="text" class="form-control text-dark text-center" value="$0" id="appointment_bonus_total_count" readonly>
                                                </th>
                                                <th>
                                                    <input type="text" class="form-control text-dark text-center" value="$0" id="base_pay_total_count" readonly>
                                                </th>
                                            </tr>
                                        </thead>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <!-- Total Section -->
                        <div class="col-12 col-md-6 mb-4 mb-md-0">
                            <div class="card mt-4 p-3">
                                <div class="card-body text-center">
                                    <h1>TOTAL</h1>
                                    <h1 id="grand_totals" class="grand-totals">$0.00</h1>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
        
        <!-- Monthly & Quarterly Bonuses Section -->
        <div class="bonus-section">
            <div class="row">
                <!-- Monthly Gross Sales Bonus -->
                <div class="col-12 col-md-3 mb-3">
                    <div class="bonus-card">
                        <h3>Monthly Gross Sales Bonus</h3>
                        <div class="bonus-options">
                            <label class="bonus-option">
                                <input type="checkbox" id="sales_100k" data-amount="500" data-group="sales"> 
                                <span class="bonus-label">$100,000</span>
                                <span class="bonus-amount">$500</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="sales_120k" data-amount="150" data-group="sales"> 
                                <span class="bonus-label">$120,000</span>
                                <span class="bonus-amount">+$150</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="sales_140k" data-amount="150" data-group="sales"> 
                                <span class="bonus-label">$140,000</span>
                                <span class="bonus-amount">+$150</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="sales_160k" data-amount="150" data-group="sales"> 
                                <span class="bonus-label">$160,000</span>
                                <span class="bonus-amount">+$150</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="sales_180k" data-amount="150" data-group="sales"> 
                                <span class="bonus-label">$180,000</span>
                                <span class="bonus-amount">+$150</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="sales_200k" data-amount="150" data-group="sales"> 
                                <span class="bonus-label">$200,000</span>
                                <span class="bonus-amount">+$150</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- Monthly Estimate Bonus -->
                <div class="col-12 col-md-3 mb-3">
                    <div class="bonus-card">
                        <h3>Monthly Estimate Bonus</h3>
                        <div class="bonus-options">
                            <label class="bonus-option">
                                <input type="checkbox" id="monthly_est_14" data-amount="200" data-group="monthly_est"> 
                                <span class="bonus-label">14 estimates</span>
                                <span class="bonus-amount">$200</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="monthly_est_16" data-amount="100" data-group="monthly_est"> 
                                <span class="bonus-label">16 estimates</span>
                                <span class="bonus-amount">+$100</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="monthly_est_18" data-amount="100" data-group="monthly_est"> 
                                <span class="bonus-label">18 estimates</span>
                                <span class="bonus-amount">+$100</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="monthly_est_20" data-amount="100" data-group="monthly_est"> 
                                <span class="bonus-label">20 estimates</span>
                                <span class="bonus-amount">+$100</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="monthly_est_22" data-amount="100" data-group="monthly_est"> 
                                <span class="bonus-label">22 estimates</span>
                                <span class="bonus-amount">+$100</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="monthly_est_24" data-amount="100" data-group="monthly_est"> 
                                <span class="bonus-label">24 estimates</span>
                                <span class="bonus-amount">+$100</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="monthly_est_26" data-amount="100" data-group="monthly_est"> 
                                <span class="bonus-label">26 estimates</span>
                                <span class="bonus-amount">+$100</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="monthly_est_28" data-amount="100" data-group="monthly_est"> 
                                <span class="bonus-label">28 estimates</span>
                                <span class="bonus-amount">+$100</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="monthly_est_30" data-amount="100" data-group="monthly_est"> 
                                <span class="bonus-label">30 estimates</span>
                                <span class="bonus-amount">+$100</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- Quarterly Estimate Bonus -->
                <div class="col-12 col-md-3 mb-3">
                    <div class="bonus-card">
                        <h3>Quarterly Estimate Bonus</h3>
                        <div class="bonus-options">
                            <label class="bonus-option">
                                <input type="checkbox" id="quarterly_est_50" data-amount="600" data-group="quarterly_est"> 
                                <span class="bonus-label">50 estimates</span>
                                <span class="bonus-amount">$600</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="quarterly_est_60" data-amount="150" data-group="quarterly_est"> 
                                <span class="bonus-label">60 estimates</span>
                                <span class="bonus-amount">+$150</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="quarterly_est_70" data-amount="150" data-group="quarterly_est"> 
                                <span class="bonus-label">70 estimates</span>
                                <span class="bonus-amount">+$150</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="quarterly_est_80" data-amount="300" data-group="quarterly_est"> 
                                <span class="bonus-label">80 estimates</span>
                                <span class="bonus-amount">+$300</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="quarterly_est_90" data-amount="400" data-group="quarterly_est"> 
                                <span class="bonus-label">90 estimates</span>
                                <span class="bonus-amount">+$400</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="quarterly_est_100" data-amount="400" data-group="quarterly_est"> 
                                <span class="bonus-label">100 estimates</span>
                                <span class="bonus-amount">+$400</span>
                            </label>
                        </div>
                    </div>
                </div>
                
                <!-- Yearly Estimate Bonus -->
                <div class="col-12 col-md-3 mb-3">
                    <div class="bonus-card">
                        <h3>Yearly Estimate Bonus</h3>
                        <div class="bonus-options">
                            <label class="bonus-option">
                                <input type="checkbox" id="yearly_est_175" data-amount="5000" data-group="yearly_est"> 
                                <span class="bonus-label">175 estimates</span>
                                <span class="bonus-amount">$5,000</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="yearly_est_200" data-amount="1500" data-group="yearly_est"> 
                                <span class="bonus-label">200 estimates</span>
                                <span class="bonus-amount">+$1,500</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="yearly_est_225" data-amount="1500" data-group="yearly_est"> 
                                <span class="bonus-label">225 estimates</span>
                                <span class="bonus-amount">+$1,500</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="yearly_est_250" data-amount="2000" data-group="yearly_est"> 
                                <span class="bonus-label">250 estimates</span>
                                <span class="bonus-amount">+$2,000</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="yearly_est_275" data-amount="2500" data-group="yearly_est"> 
                                <span class="bonus-label">275 estimates</span>
                                <span class="bonus-amount">+$2,500</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="yearly_est_300" data-amount="2500" data-group="yearly_est"> 
                                <span class="bonus-label">300 estimates</span>
                                <span class="bonus-amount">+$2,500</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="yearly_est_325" data-amount="2500" data-group="yearly_est"> 
                                <span class="bonus-label">325 estimates</span>
                                <span class="bonus-amount">+$2,500</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="yearly_est_350" data-amount="2500" data-group="yearly_est"> 
                                <span class="bonus-label">350 estimates</span>
                                <span class="bonus-amount">+$2,500</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="yearly_est_375" data-amount="2500" data-group="yearly_est"> 
                                <span class="bonus-label">375 estimates</span>
                                <span class="bonus-amount">+$2,500</span>
                            </label>
                            <label class="bonus-option">
                                <input type="checkbox" id="yearly_est_400" data-amount="2500" data-group="yearly_est"> 
                                <span class="bonus-label">400 estimates</span>
                                <span class="bonus-amount">+$2,500</span>
                            </label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Account Activity Section -->
        <div class="activity-section">
            <h2>Account Activity</h2>
            <div id="activity-feed">
                <div class="no-activity">Enter your appointments and estimates above to see activity</div>
            </div>
        </div>
    </div>

    <!-- Clear Button -->
    <button class="btn btn-danger btn-clear" onclick="clearAll()" title="Clear All">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
            <path d="M2.5 1a1 1 0 0 0-1 1v1a1 1 0 0 0 1 1H3v9a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2V4h.5a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H10a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1H2.5zm3 4a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 .5-.5zM8 5a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-1 0v-7A.5.5 0 0 1 8 5zm3 .5v7a.5.5 0 0 1-1 0v-7a.5.5 0 0 1 1 0z"/>
        </svg>
    </button>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>

    <script>
        // Constants
        const BASE_PAY_RATE = 15.49;
        const DAYS = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
        const DAYS_FULL = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'];

        // Calculation functions (converted from PHP)
        function calculateDailyAppointmentValue(value) {
            if (value >= 10) return 500;
            if (value === 9) return 350;
            if (value === 8) return 250;
            if (value === 7) return 200;
            if (value === 6) return 150;
            if (value === 5) return 100;
            if (value >= 4) return 50;
            if (value === 3) return 25;
            return 0;
        }

        function calculateWeeklyAppointmentBonus(weeklyTotal) {
            if (weeklyTotal >= 40) return 500;
            if (weeklyTotal >= 35) return 400;
            if (weeklyTotal >= 30) return 300;
            if (weeklyTotal >= 25) return 200;
            if (weeklyTotal >= 20) return 150;
            if (weeklyTotal >= 15) return 100;
            return 0;
        }

        function calculateWeekAppointmentSum(dailyValues, weeklyTotal) {
            let sum = 0;
            for (let i = 0; i < dailyValues.length; i++) {
                sum += calculateDailyAppointmentValue(dailyValues[i]);
            }
            sum += calculateWeeklyAppointmentBonus(weeklyTotal);
            return sum;
        }

        function calculateEstimateBonus(weeklyEstimates) {
            if (weeklyEstimates >= 7) return 500;
            if (weeklyEstimates === 6) return 400;
            if (weeklyEstimates === 5) return 300;
            if (weeklyEstimates === 4) return 200;
            return 0;
        }

        function calculateCommission(totalEstimates) {
            if (totalEstimates >= 6) {
                return (totalEstimates - 5) * 200;
            }
            return 0;
        }

        // Get input value helper
        function getVal(id) {
            const el = document.getElementById(id);
            return el ? parseFloat(el.value) || 0 : 0;
        }

        // Create activity card HTML
        function createActivityCard(day, title, detail, amount) {
            return `
                <div class="activity-card">
                    <div class="activity-day">${day}</div>
                    <div class="activity-description">
                        <div class="activity-description-label">Description</div>
                        <div class="activity-description-title">${title}</div>
                        <div class="activity-description-detail">${detail}</div>
                    </div>
                    <div class="activity-amount">
                        <div class="activity-amount-label">Amount</div>
                        <div class="activity-amount-value">$${amount.toFixed(2)}</div>
                    </div>
                </div>
            `;
        }

        // Build activity feed
        function buildActivityFeed(w1Appts, w2Appts, w1EstsTotal, w2EstsTotal, totalEstimates) {
            let activities = [];
            
            // Week 1 Daily Appointments
            w1Appts.forEach((appts, index) => {
                const bonus = calculateDailyAppointmentValue(appts);
                if (bonus > 0) {
                    activities.push({
                        day: DAYS_FULL[index],
                        dayShort: DAYS[index].toUpperCase(),
                        title: 'Daily Appointment',
                        detail: `${appts} appts (Week 1)`,
                        amount: bonus,
                        order: index
                    });
                }
            });
            
            // Week 2 Daily Appointments
            w2Appts.forEach((appts, index) => {
                const bonus = calculateDailyAppointmentValue(appts);
                if (bonus > 0) {
                    activities.push({
                        day: DAYS_FULL[index],
                        dayShort: DAYS[index].toUpperCase(),
                        title: 'Daily Appointment',
                        detail: `${appts} appts (Week 2)`,
                        amount: bonus,
                        order: index + 7
                    });
                }
            });
            
            // Week 1 Weekly Appointment Bonuses (incremental)
            const w1Total = w1Appts.reduce((a, b) => a + b, 0);
            if (w1Total >= 15) {
                activities.push({
                    day: 'FRI',
                    dayShort: 'FRI',
                    title: 'Weekly Appointment',
                    detail: `15 appts for Week 1`,
                    amount: 100,
                    order: 100
                });
            }
            if (w1Total >= 20) {
                activities.push({
                    day: 'FRI',
                    dayShort: 'FRI',
                    title: 'Weekly Appointment',
                    detail: `20 appts for Week 1`,
                    amount: 50,
                    order: 100.1
                });
            }
            if (w1Total >= 25) {
                activities.push({
                    day: 'FRI',
                    dayShort: 'FRI',
                    title: 'Weekly Appointment',
                    detail: `25 appts for Week 1`,
                    amount: 50,
                    order: 100.2
                });
            }
            if (w1Total >= 30) {
                activities.push({
                    day: 'FRI',
                    dayShort: 'FRI',
                    title: 'Weekly Appointment',
                    detail: `30 appts for Week 1`,
                    amount: 100,
                    order: 100.3
                });
            }
            if (w1Total >= 35) {
                activities.push({
                    day: 'FRI',
                    dayShort: 'FRI',
                    title: 'Weekly Appointment',
                    detail: `35 appts for Week 1`,
                    amount: 100,
                    order: 100.4
                });
            }
            if (w1Total >= 40) {
                activities.push({
                    day: 'FRI',
                    dayShort: 'FRI',
                    title: 'Weekly Appointment',
                    detail: `40 appts for Week 1`,
                    amount: 100,
                    order: 100.5
                });
            }
            
            // Week 2 Weekly Appointment Bonuses (incremental)
            const w2Total = w2Appts.reduce((a, b) => a + b, 0);
            if (w2Total >= 15) {
                activities.push({
                    day: 'FRI',
                    dayShort: 'FRI',
                    title: 'Weekly Appointment',
                    detail: `15 appts for Week 2`,
                    amount: 100,
                    order: 101
                });
            }
            if (w2Total >= 20) {
                activities.push({
                    day: 'FRI',
                    dayShort: 'FRI',
                    title: 'Weekly Appointment',
                    detail: `20 appts for Week 2`,
                    amount: 50,
                    order: 101.1
                });
            }
            if (w2Total >= 25) {
                activities.push({
                    day: 'FRI',
                    dayShort: 'FRI',
                    title: 'Weekly Appointment',
                    detail: `25 appts for Week 2`,
                    amount: 50,
                    order: 101.2
                });
            }
            if (w2Total >= 30) {
                activities.push({
                    day: 'FRI',
                    dayShort: 'FRI',
                    title: 'Weekly Appointment',
                    detail: `30 appts for Week 2`,
                    amount: 100,
                    order: 101.3
                });
            }
            if (w2Total >= 35) {
                activities.push({
                    day: 'FRI',
                    dayShort: 'FRI',
                    title: 'Weekly Appointment',
                    detail: `35 appts for Week 2`,
                    amount: 100,
                    order: 101.4
                });
            }
            if (w2Total >= 40) {
                activities.push({
                    day: 'FRI',
                    dayShort: 'FRI',
                    title: 'Weekly Appointment',
                    detail: `40 appts for Week 2`,
                    amount: 100,
                    order: 101.5
                });
            }
            
            // Week 1 Estimate Bonuses (incremental)
            if (w1EstsTotal >= 4) {
                activities.push({
                    day: 'SAT',
                    dayShort: 'SAT',
                    title: 'Weekly Estimate',
                    detail: `4 estimates for Week 1`,
                    amount: 200,
                    order: 102
                });
            }
            if (w1EstsTotal >= 5) {
                activities.push({
                    day: 'SAT',
                    dayShort: 'SAT',
                    title: 'Weekly Estimate',
                    detail: `5th estimate for Week 1`,
                    amount: 100,
                    order: 102.1
                });
            }
            if (w1EstsTotal >= 6) {
                activities.push({
                    day: 'SAT',
                    dayShort: 'SAT',
                    title: 'Weekly Estimate',
                    detail: `6th estimate for Week 1`,
                    amount: 100,
                    order: 102.2
                });
            }
            if (w1EstsTotal >= 7) {
                activities.push({
                    day: 'SAT',
                    dayShort: 'SAT',
                    title: 'Weekly Estimate',
                    detail: `7th estimate for Week 1`,
                    amount: 100,
                    order: 102.3
                });
            }
            
            // Week 2 Estimate Bonuses (incremental)
            if (w2EstsTotal >= 4) {
                activities.push({
                    day: 'SAT',
                    dayShort: 'SAT',
                    title: 'Weekly Estimate',
                    detail: `4 estimates for Week 2`,
                    amount: 200,
                    order: 103
                });
            }
            if (w2EstsTotal >= 5) {
                activities.push({
                    day: 'SAT',
                    dayShort: 'SAT',
                    title: 'Weekly Estimate',
                    detail: `5th estimate for Week 2`,
                    amount: 100,
                    order: 103.1
                });
            }
            if (w2EstsTotal >= 6) {
                activities.push({
                    day: 'SAT',
                    dayShort: 'SAT',
                    title: 'Weekly Estimate',
                    detail: `6th estimate for Week 2`,
                    amount: 100,
                    order: 103.2
                });
            }
            if (w2EstsTotal >= 7) {
                activities.push({
                    day: 'SAT',
                    dayShort: 'SAT',
                    title: 'Weekly Estimate',
                    detail: `7th estimate for Week 2`,
                    amount: 100,
                    order: 103.3
                });
            }
            
            // Estimate Commission (incremental - $200 for each estimate after 5)
            const commission = calculateCommission(totalEstimates);
            if (totalEstimates >= 6) {
                for (let i = 6; i <= totalEstimates; i++) {
                    activities.push({
                        day: 'MON',
                        dayShort: 'MON',
                        title: 'Estimate Commission',
                        detail: `${i}${i === 6 ? 'th' : i === 7 ? 'th' : i === 8 ? 'th' : i === 9 ? 'th' : 'th'} estimate`,
                        amount: 200,
                        order: 104 + (i - 6) * 0.1
                    });
                }
            }
            
            return activities;
        }

        // Get Monthly/Quarterly bonus activities
        function getMonthlyQuarterlyActivities() {
            let activities = [];
            
            // Monthly Gross Sales Bonus
            const salesTiers = [
                { id: 'sales_100k', label: '$100,000 gross sales', amount: 500 },
                { id: 'sales_120k', label: '$120,000 gross sales', amount: 150 },
                { id: 'sales_140k', label: '$140,000 gross sales', amount: 150 },
                { id: 'sales_160k', label: '$160,000 gross sales', amount: 150 },
                { id: 'sales_180k', label: '$180,000 gross sales', amount: 150 },
                { id: 'sales_200k', label: '$200,000 gross sales', amount: 150 }
            ];
            
            salesTiers.forEach((tier, index) => {
                if (document.getElementById(tier.id)?.checked) {
                    activities.push({
                        dayShort: 'MONTHLY',
                        title: 'Monthly Gross Sales Bonus',
                        detail: tier.label,
                        amount: tier.amount,
                        order: 200 + index
                    });
                }
            });
            
            // Monthly Estimate Bonus
            const monthlyEstTiers = [
                { id: 'monthly_est_14', label: '14 estimates (monthly)', amount: 200 },
                { id: 'monthly_est_16', label: '16 estimates (monthly)', amount: 100 },
                { id: 'monthly_est_18', label: '18 estimates (monthly)', amount: 100 },
                { id: 'monthly_est_20', label: '20 estimates (monthly)', amount: 100 },
                { id: 'monthly_est_22', label: '22 estimates (monthly)', amount: 100 },
                { id: 'monthly_est_24', label: '24 estimates (monthly)', amount: 100 },
                { id: 'monthly_est_26', label: '26 estimates (monthly)', amount: 100 },
                { id: 'monthly_est_28', label: '28 estimates (monthly)', amount: 100 },
                { id: 'monthly_est_30', label: '30 estimates (monthly)', amount: 100 }
            ];
            
            monthlyEstTiers.forEach((tier, index) => {
                if (document.getElementById(tier.id)?.checked) {
                    activities.push({
                        dayShort: 'MONTHLY',
                        title: 'Monthly Estimate Bonus',
                        detail: tier.label,
                        amount: tier.amount,
                        order: 210 + index
                    });
                }
            });
            
            // Quarterly Estimate Bonus
            const quarterlyTiers = [
                { id: 'quarterly_est_50', label: '50 estimates (quarterly)', amount: 600 },
                { id: 'quarterly_est_60', label: '60 estimates (quarterly)', amount: 150 },
                { id: 'quarterly_est_70', label: '70 estimates (quarterly)', amount: 150 },
                { id: 'quarterly_est_80', label: '80 estimates (quarterly)', amount: 300 },
                { id: 'quarterly_est_90', label: '90 estimates (quarterly)', amount: 400 },
                { id: 'quarterly_est_100', label: '100 estimates (quarterly)', amount: 400 }
            ];
            
            quarterlyTiers.forEach((tier, index) => {
                if (document.getElementById(tier.id)?.checked) {
                    activities.push({
                        dayShort: 'QUARTERLY',
                        title: 'Quarterly Estimate Bonus',
                        detail: tier.label,
                        amount: tier.amount,
                        order: 220 + index
                    });
                }
            });
            
            // Yearly Estimate Bonus
            const yearlyTiers = [
                { id: 'yearly_est_175', label: '175 estimates (yearly)', amount: 5000 },
                { id: 'yearly_est_200', label: '200 estimates (yearly)', amount: 1500 },
                { id: 'yearly_est_225', label: '225 estimates (yearly)', amount: 1500 },
                { id: 'yearly_est_250', label: '250 estimates (yearly)', amount: 2000 },
                { id: 'yearly_est_275', label: '275 estimates (yearly)', amount: 2500 },
                { id: 'yearly_est_300', label: '300 estimates (yearly)', amount: 2500 },
                { id: 'yearly_est_325', label: '325 estimates (yearly)', amount: 2500 },
                { id: 'yearly_est_350', label: '350 estimates (yearly)', amount: 2500 },
                { id: 'yearly_est_375', label: '375 estimates (yearly)', amount: 2500 },
                { id: 'yearly_est_400', label: '400 estimates (yearly)', amount: 2500 }
            ];
            
            yearlyTiers.forEach((tier, index) => {
                if (document.getElementById(tier.id)?.checked) {
                    activities.push({
                        dayShort: 'YEARLY',
                        title: 'Yearly Estimate Bonus',
                        detail: tier.label,
                        amount: tier.amount,
                        order: 230 + index
                    });
                }
            });
            
            return activities;
        }
        
        // Calculate Monthly/Quarterly bonus totals
        function getMonthlyQuarterlyTotal() {
            let total = 0;
            document.querySelectorAll('.bonus-option input[type="checkbox"]:checked').forEach(cb => {
                total += parseInt(cb.dataset.amount) || 0;
            });
            return total;
        }

        // Main calculation function
        function calculate() {
            // Week 1 First Row (Appointments)
            const w1Appts = [
                getVal('mon_w1_user_input_first_row'),
                getVal('tue_w1_user_input_first_row'),
                getVal('wed_w1_user_input_first_row'),
                getVal('thu_w1_user_input_first_row'),
                getVal('fri_w1_user_input_first_row'),
                getVal('sat_w1_user_input_first_row'),
                getVal('sun_w1_user_input_first_row')
            ];
            const w1ApptsTotal = w1Appts.reduce((a, b) => a + b, 0);

            // Week 1 Second Row (Estimates)
            const w1Ests = [
                getVal('mon_w1_user_input_second_row'),
                getVal('tue_w1_user_input_second_row'),
                getVal('wed_w1_user_input_second_row'),
                getVal('thu_w1_user_input_second_row'),
                getVal('fri_w1_user_input_second_row'),
                getVal('sat_w1_user_input_second_row'),
                getVal('sun_w1_user_input_second_row')
            ];
            const w1EstsTotal = w1Ests.reduce((a, b) => a + b, 0);

            // Week 2 First Row (Appointments)
            const w2Appts = [
                getVal('mon_w2_user_input_first_row'),
                getVal('tue_w2_user_input_first_row'),
                getVal('wed_w2_user_input_first_row'),
                getVal('thu_w2_user_input_first_row'),
                getVal('fri_w2_user_input_first_row'),
                getVal('sat_w2_user_input_first_row'),
                getVal('sun_w2_user_input_first_row')
            ];
            const w2ApptsTotal = w2Appts.reduce((a, b) => a + b, 0);

            // Week 2 Second Row (Estimates)
            const w2Ests = [
                getVal('mon_w2_user_input_second_row'),
                getVal('tue_w2_user_input_second_row'),
                getVal('wed_w2_user_input_second_row'),
                getVal('thu_w2_user_input_second_row'),
                getVal('fri_w2_user_input_second_row'),
                getVal('sat_w2_user_input_second_row'),
                getVal('sun_w2_user_input_second_row')
            ];
            const w2EstsTotal = w2Ests.reduce((a, b) => a + b, 0);

            // Update row totals
            document.getElementById('w1_first_row_total').textContent = w1ApptsTotal;
            document.getElementById('w1_second_row_total').textContent = w1EstsTotal;
            document.getElementById('w2_first_row_total').textContent = w2ApptsTotal;
            document.getElementById('w2_second_row_total').textContent = w2EstsTotal;

            // Calculate bonuses
            const week1ApptBonus = calculateWeekAppointmentSum(w1Appts, w1ApptsTotal);
            const week2ApptBonus = calculateWeekAppointmentSum(w2Appts, w2ApptsTotal);
            const appointmentBonus = week1ApptBonus + week2ApptBonus;

            const week1EstBonus = calculateEstimateBonus(w1EstsTotal);
            const week2EstBonus = calculateEstimateBonus(w2EstsTotal);

            const totalEstimates = w1EstsTotal + w2EstsTotal;
            const commission = calculateCommission(totalEstimates);

            const combined = week1EstBonus + week2EstBonus + commission;

            const hoursWorked = getVal('hours_worked_count_total');
            const basePay = hoursWorked * BASE_PAY_RATE;
            
            // Get monthly/quarterly bonuses
            const monthlyQuarterlyTotal = getMonthlyQuarterlyTotal();

            const grandTotal = combined + appointmentBonus + basePay + monthlyQuarterlyTotal;

            // Update display
            document.getElementById('total_estimates_count_total').value = totalEstimates;
            document.getElementById('commission_total_count').value = '$' + commission;
            document.getElementById('combined_total_count').value = '$' + combined;
            document.getElementById('appointment_bonus_total_count').value = '$' + appointmentBonus;
            document.getElementById('base_pay_total_count').value = '$' + basePay.toFixed(2);
            document.getElementById('grand_totals').textContent = '$' + grandTotal.toFixed(2);

            // Build and display activity feed
            const activities = buildActivityFeed(w1Appts, w2Appts, w1EstsTotal, w2EstsTotal, totalEstimates);
            
            // Add monthly/quarterly activities
            const monthlyQuarterlyActivities = getMonthlyQuarterlyActivities();
            activities.push(...monthlyQuarterlyActivities);
            
            const feedEl = document.getElementById('activity-feed');
            
            if (activities.length === 0) {
                feedEl.innerHTML = '<div class="no-activity">Enter your appointments and estimates above to see activity</div>';
            } else {
                // Sort by order (most recent first for display)
                activities.sort((a, b) => b.order - a.order);
                feedEl.innerHTML = activities.map(a => createActivityCard(a.dayShort, a.title, a.detail, a.amount)).join('');
            }

            // Save to localStorage
            saveData();
        }

        // Clear all inputs
        function clearAll() {
            if (confirm('Clear all data?')) {
                const inputs = document.querySelectorAll('input[type="number"]');
                inputs.forEach(input => input.value = 0);
                calculate();
                localStorage.removeItem('payPeriodData');
            }
        }

        // Save data to localStorage
        function saveData() {
            const data = {};
            const inputs = document.querySelectorAll('input[type="number"]');
            inputs.forEach(input => {
                data[input.id] = input.value;
            });
            
            // Save checkbox states
            const checkboxes = document.querySelectorAll('.bonus-option input[type="checkbox"]');
            checkboxes.forEach(cb => {
                data[cb.id] = cb.checked;
            });
            
            localStorage.setItem('payPeriodData', JSON.stringify(data));
        }

        // Load data from localStorage
        function loadData() {
            const saved = localStorage.getItem('payPeriodData');
            if (saved) {
                const data = JSON.parse(saved);
                Object.keys(data).forEach(id => {
                    const el = document.getElementById(id);
                    if (el) {
                        if (el.type === 'checkbox') {
                            el.checked = data[id];
                        } else {
                            el.value = data[id];
                        }
                    }
                });
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            calculate();

            // Add event listeners to all inputs
            const form = document.getElementById('jms_pay_period_calc_form');
            form.addEventListener('input', calculate);
            
            // Add event listeners to bonus checkboxes
            document.querySelectorAll('.bonus-option input[type="checkbox"]').forEach(cb => {
                cb.addEventListener('change', calculate);
            });

            // Select all on focus for easier editing
            document.querySelectorAll('.th-input').forEach(input => {
                input.addEventListener('focus', function() {
                    this.select();
                });
            });
        });

        // Register service worker for PWA (optional)
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function() {
                navigator.serviceWorker.register('sw.js').catch(function(err) {
                    console.log('ServiceWorker registration failed: ', err);
                });
            });
        }
    </script>
</body>
</html>
